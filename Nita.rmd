---
title: "Nita"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
pkgs <- c("keras", "lime", "tidyquant", "rsample", "recipes", "yardstick", "corrr")
install.packages(pkgs)
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(keras)
library(lime)
library(tidyquant)
library(rsample)
library(recipes)
library(yardstick)
library(corrr)
```

```{r}
LowerS <- read.csv("data/LowerS.csv")
percent_UP <- read.csv("data/percent_urban_population.csv")
procedures <- read.csv("data/procedures.csv")
sexratio <- read.csv("data/sexratio.csv")
time <- read.csv("data/time.csv")
EODB_index <- read.csv("data/EODB-index.csv")


LowerS1 <- LowerS %>%
  select (Country.Code , Country.Name, X2006:X2018) %>%
  gather("Year","LowerSecondary",3:15) %>%
  arrange(desc(Year)) %>%
  arrange(Country.Name)  %>%
  mutate(Year, Year = str_replace(Year, "X", "")) %>%
  select(Country = Country.Name, Code = Country.Code, Year, LowerSecondary)

percent_UP1 <- percent_UP %>%
  select (Country.Code , Country.Name, X2006:X2018) %>%
  gather("Year","Percent_Urban_Population",3:15) %>%
  arrange(desc(Year)) %>%
  arrange(Country.Name)  %>%
  mutate(Year, Year = str_replace(Year, "X", "")) %>%
  select(Country = Country.Name, Code = Country.Code, Year, Percent_Urban_Population)

procedures1 <- procedures %>%
  select (Country.Code , Country.Name, X2006:X2018) %>%
  gather("Year","procedures",3:15) %>%
  arrange(desc(Year)) %>%
  arrange(Country.Name)  %>%
  mutate(Year, Year = str_replace(Year, "X", "")) %>%
  select(Country = Country.Name, Code = Country.Code, Year, procedures)
  
sexratio1 <- sexratio %>%
  select (Country.Code , Country.Name, X2006:X2018) %>%
  gather("Year","sexratio",3:15) %>%
  arrange(desc(Year)) %>%
  arrange(Country.Name)  %>%
  mutate(Year, Year = str_replace(Year, "X", "")) %>%
  select(Country = Country.Name, Code = Country.Code, Year, sexratio)

time1 <- time %>%
  select (Country.Code , Country.Name, X2006:X2018) %>%
  gather("Year","time_days",3:15) %>%
  arrange(desc(Year)) %>%
  arrange(Country.Name)  %>%
  mutate(Year, Year = str_replace(Year, "X", "")) %>%
  select(Country = Country.Name, Code = Country.Code, Year, time_days)
  
EODB_index1 <- EODB_index %>%
  select (Jurisdiction, X2018:X2006) %>%
  gather("Year","EODB_index",2:14) %>%
  mutate(Year, Year = str_replace(Year, "X", "")) %>%
  select(Country = Jurisdiction, Year, EODB_index) %>%
  filter((Year == 2018))

```



```{r}
#missing_values in cost all filled
for (i in 1:length(Xian1$Cost)) {
  if (is.na(Xian1$Cost[i]) == TRUE) {
    if (Xian1$Country[i] == Xian1$Country[i-1]){
    Xian1$Cost[i] = Xian1$Cost[i-1]}
  }
}
for (i in length(Xian1$Cost):1) {
  if (is.na(Xian1$Cost[i]) == TRUE) {
    if (Xian1$Country[i] == Xian1$Country[i+1]){
    Xian1$Cost[i] = Xian1$Cost[i+1]}
  }
}
xian2 <- Xian1 %>%
  filter(is.na(Cost) == TRUE)
```

```{r}
#missing_values in LowerS
for (i in 2:length(Xian1$LowerSecondary)) {
  if (is.na(Xian1$LowerSecondary[i]) == TRUE) {
    if (Xian1$Country[i] == Xian1$Country[i-1]){
    Xian1$LowerSecondary[i] = Xian1$LowerSecondary[i-1]}
  }
}
for (i in length(Xian1$LowerSecondary):1) {
  if (is.na(Xian1$LowerSecondary[i]) == TRUE) {
    if (Xian1$Country[i] == Xian1$Country[i+1]){
    Xian1$LowerSecondary[i] = Xian1$LowerSecondary[i+1]}
  }
}
xian2 <- Xian1 %>%
  filter(is.na(LowerSecondary) == TRUE) %>%
  select(Country, LowerSecondary, EODB_index) %>%
  group_by(Country) %>%
  summarise(size = n())
#15 countries has missing values for all the years
```


```{r}
#missing values for indexes
xian3 <- Xian1 %>%
  filter(is.na(EODB_index) == TRUE) %>%
  select(Country, EODB_index)
```

```{r}
Xian1 <- Xian1 %>%
  drop_na(EODB_index)
```
